- 오늘날 많은 애플리케이션은 계산 중심과는 다르게 데이터 중심적이다.
- 데이터 중심 애플리케이션은 다음과 같은 기능들을 필요로 한다.
	- 구동 애플리케이션이나 다른 애플리케이션에서 나중에 다시 데이터를 찾을 수 있게 데이터를 저장(데이터 베이스)
	- 읽기 속도 향상을 위해 값비싼 수행 결과를 기억(캐시)
	- 사용자가 키워드로 데이터를 검색하거나 다양한 방법으로 필터링할 수 있게 제공( 검색 색인)
	- 비동기 처리를 위해 다른 프로세스로 메시지 보내기
	- 주기적으로 대량의 누적된 데이터를 분석( 일괄 처리)

## 신뢰성

- 누구나 어떤 것을 신뢰하거나 신뢰하지 않는다는 의미가 무엇인지에 대한 직관적인 개념을 가지고 있다
- 소프트웨어의 경우 일반적인 기대치는 다음과 같다.
	- 애플리케이션은 사용자가 기대한 기능을 수행한다.
	- 시스템은 사용자가 범한 실수나 예상치 못한 소프트웨어 사용법을 허용할 수 있다.
	- 시스템 성능은 예상된 부하와 데이터 양에서 필수적인 사용 사례를 충분히 만족한다.
	- 시스템은 허가되지 않은 접근과 오남용을 방지한다.
- 잘못될 수 있는 일을 ==결함== 이라고 부른다.
- 결함을 예측하고 대처할 수 있는 시스템을 ==내결함성== 또는 ==탄력성== 을가졌다고 한다.
- 결함과 장애는 동일하지 않다.
- ==장애==는 사용자에게 필요한 서비스를 제공하지 못하고 시스템 전체가 멈춘 경우다.

### 하드웨어 결함
- 시스템 장애율을 줄이기 위한 방법으로 각 하드웨어 구성 요소에 중복을 추가하는 방법이 일반적이다.
- 디스크는 RAID 구성
- 서버는 이중 전원 디바이스와 핫 스왑 가능한 CPU
- 데이터센터는 건전지와 예비 전원용 디젤 발전기를 갖출 수 있다.
- 최근에는 소프트웨어 내결함성 기술을 사용하거나 하드웨어 중복성을 추가해 전체 장비의 손실을 견딜 수 있는 시스템으로 발전 중

### 인적 오류
- 사람이 최선의 의도를 갖고 있어도 오류가 발생 할 수 있다.
- 운영자의 설정 오류가 중단의 주요 원인인 반면 , 하드웨어 결함은 중단 원인의 10~25%정도에 그친다.
- 오류의 가능성을 최소화 하는 방향으로 시스템 설계
	- 잘 설계된 추상화 , API , 관리 인터페이스를 사용한다.
- 사람이 가장 많이 실수하는 장소에서 사람의 실수로 장애가 발생 할 수 있는 부분을 분리
- 단위 테스트부터 시스템 통합 테스트까지 철저하게 테스트 하라.
- 인적 오류를 빠르고 쉽게 복구할 수 있게 하라
- 성능 지표와 오류율 같은 상세하고 명확한 모니터링 대책을 마련



### 확장성
- 성능 저하의 가장 흔한 이유는 부하 증가
- 확정성은 증가한 부하에 대처하는 시스템 능력을 설명하는 데 사용하는 용어

#### 부하 기술하기
- 부하는 부하 매개 변수라 부르는 몇 개의 숫자로 나타낼 수 있다.
- 부하 매개 변수 선택은 시스템의 설계에 따라 다르다.


#### 트위터 예시
- 트위터는 트윗 작성( 초당 4.6k, 피크일때 12k)
-  홈 타임라인(초당 300k) 주요 두 가지 동작이 있다.
- 트위터의 확장성 문제는 팬아웃 때문
- 개별 사용자는 많은 사람을 팔로우하고 많은 사람이 개별 사용자를 팔로우한다.

```sql
select tweets.*, users.* from tweets
	join users on tweets.sender_id = users.id
	join follows on follows.followee_id = users.id
	where follows.follower_id = current_user
```
- 쿼리는 새로운 트윗을 트윗 전역 컬렉션에 삽입
- 사용자가 타임라인을 요청하면 팔로우 하는 사람들의 모든 트윗을 찾아 시간순으로 정렬해서 합친다.

2. 각 사용자 트윗 우편함처럼 개별 사용자의 홈 타임라인 캐시를 유지한다.
	- 사용자가 트윗을 작성하면 해당 사용자를 팔로우하는 모든 사람을 찾고 각자의 홈 타임라인 캐시에 새로운 트윗을 삽입한다.
- 평균적으로 트윗 게시 요청량이 읽기 요청량에 비해 수백배 적기 때문에 접근 방식 2가 더 잘 동작한다.
- 접근 방식 2는 부가작업이 많이 필요하다. ( 예를 들어 팔로워수가 많은 사용자가 요청하면 더 오래 걸린다.)
- 팔로워가 많은 사용자는 따로 팬아웃에서 제외

## 성능 기술하기








